# 服务器启动说明

## 问题描述

您遇到的错误：
```
ModuleNotFoundError: No module named 'core'
```

这是因为Python无法找到`core`模块，通常是由于：
1. 运行目录不正确
2. Python路径配置问题
3. 模块导入路径错误

## 解决方案

### 方法1：使用启动脚本（推荐）

**步骤1：在项目根目录运行**
```bash
# 确保在项目根目录
cd D:\git_project\cableTest\cableTest_v2\git\cableTest-version2

# 运行启动脚本
python run_server.py
```

**步骤2：验证服务器启动**
```
🚀 启动线缆测试系统Flask服务器...
当前目录: D:\git_project\cableTest\cableTest_v2\git\cableTest-version2
添加路径: D:\git_project\cableTest\cableTest_v2\git\cableTest-version2\src
✅ 服务器导入成功
🌐 启动服务器...
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.x.x:5000
```

### 方法2：手动修复导入问题

**步骤1：修改导入语句**
在`src/server/flask_server.py`中，已经添加了路径修复：
```python
import sys
import os
sys.path.append(os.path.join(os.path.dirname(__file__), '..'))
from core.cable_test_system import CableTestSystem, TestResult, RelayState
```

**步骤2：从正确目录启动**
```bash
# 从项目根目录启动
cd D:\git_project\cableTest\cableTest_v2\git\cableTest-version2
python src/server/flask_server.py
```

### 方法3：使用Python模块方式

**步骤1：在项目根目录创建启动脚本**
```bash
cd D:\git_project\cableTest\cableTest_v2\git\cableTest-version2
python -m src.server.flask_server
```

## 项目结构说明

```
cableTest-version2/
├── src/
│   ├── core/
│   │   ├── __init__.py
│   │   ├── cable_test_system.py
│   │   └── config.py
│   ├── server/
│   │   ├── __init__.py
│   │   ├── flask_server.py
│   │   └── run_server.py
│   └── utils/
│       ├── __init__.py
│       └── ...
├── testFlaskClient/
│   ├── efficient_batch_test.py
│   ├── quick_monitor.py
│   └── ...
├── run_server.py          # 启动脚本
└── start_server.py        # 备用启动脚本
```

## 启动流程

### 1. 启动服务器
```bash
# 在项目根目录
python run_server.py
```

### 2. 启动实时监控
```bash
# 在另一个终端，项目根目录
cd testFlaskClient
python quick_monitor.py
```

### 3. 运行测试
```bash
# 在第三个终端，项目根目录
cd testFlaskClient
python efficient_batch_test.py
```

## 常见问题

### 问题1：模块找不到
**症状**：`ModuleNotFoundError: No module named 'core'`
**解决**：使用`run_server.py`启动脚本

### 问题2：端口被占用
**症状**：`Address already in use`
**解决**：
```bash
# 查找占用端口的进程
netstat -ano | findstr :5000

# 终止进程
taskkill /PID <进程ID> /F
```

### 问题3：权限不足
**症状**：`Permission denied`
**解决**：以管理员身份运行命令提示符

## 验证服务器状态

### 1. 检查服务器是否运行
```bash
curl http://localhost:5000/api/system/info
```

### 2. 检查API接口
- 系统信息：`GET /api/system/info`
- 关系矩阵：`GET /api/relationships/matrix`
- 执行测试：`POST /api/experiment`
- 继电器统计：`GET /api/relay/stats`
- 重置继电器：`POST /api/relay/reset`

### 3. 检查实时监控
```bash
cd testFlaskClient
python quick_monitor.py
```

## 总结

使用`run_server.py`启动脚本是最简单可靠的方法：

1. **确保在项目根目录**
2. **运行启动脚本**：`python run_server.py`
3. **验证服务器启动成功**
4. **启动实时监控和测试**

这样可以避免模块导入问题，确保服务器正常启动！
